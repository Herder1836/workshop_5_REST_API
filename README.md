# üõ¢Ô∏è REST API –¥–ª—è –º–µ—Ä–µ–∂—ñ –ê–ó–° ‚Äî Workshop 5

## –ê–≤—Ç–æ—Ä: –ü–æ–≥–æ–Ω—è –ê–Ω–¥—Ä—ñ–π –Ü–ü–ó‚Äë3.03

## üìå –û–ø–∏—Å –ø—Ä–æ—î–∫—Ç—É

–ü—Ä–æ—î–∫—Ç —Ä–µ–∞–ª—ñ–∑—É—î —Å–µ—Ä–≤–µ—Ä–Ω—É —á–∞—Å—Ç–∏–Ω—É –ê–ó–° –Ω–∞ –±–∞–∑—ñ **Express + TypeORM + PostgreSQL**.
–ü–µ—Ä–µ–¥–±–∞—á–∞—î CRUD API –¥–ª—è –æ—Å–Ω–æ–≤–Ω–∏—Ö —Å—É—Ç–Ω–æ—Å—Ç–µ–π, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü—ñ—é —á–µ—Ä–µ–∑ **Docker**, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è **–º—ñ–≥—Ä–∞—Ü—ñ–π** —Ç–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ **Postman**.

---

üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª—ñ–≤

```
src/
 ‚îú‚îÄ‚îÄ controllers/
 ‚îÇ   ‚îú‚îÄ‚îÄ Client/
 ‚îÇ   ‚îú‚îÄ‚îÄ Operator/
 ‚îÇ   ‚îú‚îÄ‚îÄ Fuel/
 ‚îú‚îÄ‚îÄ orm/
 ‚îÇ   ‚îú‚îÄ‚îÄ entities/
 ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Client/
 ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Operator/
 ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Fuel/
 ‚îÇ   ‚îú‚îÄ‚îÄ migrations/
 ‚îÇ   ‚îú‚îÄ‚îÄ config/
 ‚îú‚îÄ‚îÄ routes/
 ‚îÇ   ‚îú‚îÄ‚îÄ client.routes.ts
 ‚îÇ   ‚îú‚îÄ‚îÄ fuel.routes.ts
 ‚îÇ   ‚îú‚îÄ‚îÄ operator.routes.ts
 ‚îÇ   ‚îú‚îÄ‚îÄ index.ts
 ‚îú‚îÄ‚îÄ index.ts
```

üê≥ Docker –∑–∞–ø—É—Å–∫

üî• Development

```bash
npm run docker:dev
```

–°–µ—Ä–≤–µ—Ä —ñ –±–∞–∑–∞ –ø—ñ–¥–Ω—ñ–º–∞—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ.

üõ¢Ô∏è –ú—ñ–≥—Ä–∞—Ü—ñ—ó
üîß –°—Ç–≤–æ—Ä–µ–Ω–Ω—è

```bash
npm run migration:generate -- -n NAME
```

‚ñ∂Ô∏è –í–∏–∫–æ–Ω–∞–Ω–Ω—è

```bash
npm run migration:run
```

üß® –í—ñ–¥–∫–∞—Ç

```bash
npm run migration:revert
```

## üß± –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ —Å—É—Ç–Ω–æ—Å—Ç—ñ —Ç–∞ –∑–≤‚Äô—è–∑–∫–∏

### üë§ Client

üìå –ó–±–µ—Ä—ñ–≥–∞—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–ª—ñ—î–Ω—Ç—ñ–≤ –ê–ó–°.

**–ü–æ–ª—è:**

- `client_id`: Primary Key
- `first_name`: string
- `last_name`: string
- `phone_number`: string | null

**–ó–≤‚Äô—è–∑–∫–∏:**

- 1 : N ‚Üí Fueling
- 1 : N ‚Üí ShopSales
- 1 : N ‚Üí Finance

---

### üë∑ Operator

üìå –ü—Ä–∞—Ü—ñ–≤–Ω–∏–∫ –ê–ó–°. –ú–∞—î —Ä–æ–ª—å.

**–ü–æ–ª—è:**

- `operator_id`
- `first_name`
- `last_name`
- `username` ‚Äî –£–Ω—ñ–∫–∞–ª—å–Ω–∏–π
- `password`
- `role`: enum(ADMIN | OPERATOR)
- `shift_number`
- `created_at`
- `gasstation`: FK

**–ó–≤‚Äô—è–∑–∫–∏:**

- 1 : N ‚Üí Fueling
- 1 : N ‚Üí ShopSales
- 1 : N ‚Üí OperatorLog

---

### ‚õΩ Fuel

üìå –¢–∏–ø –ø–∞–ª—å–Ω–æ–≥–æ.

**–ü–æ–ª—è:**

- `fuel_id`
- `fuel_name`
- `price`

**–ó–≤‚Äô—è–∑–∫–∏:**

- 1 : N ‚Üí Fueling
- 1 : N ‚Üí FuelMinPrice
- 1 : N ‚Üí Supply

---

## üåê API –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏

### üìç Client routes

| –ú–µ—Ç–æ–¥  | –ï–Ω–¥–ø–æ—ñ–Ω—Ç       | –û–ø–∏—Å           |
| ------ | -------------- | -------------- |
| GET    | `/clients`     | –û—Ç—Ä–∏–º–∞—Ç–∏ –≤—Å—ñ—Ö  |
| GET    | `/clients/:id` | –û—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ ID |
| POST   | `/clients`     | –°—Ç–≤–æ—Ä–∏—Ç–∏       |
| PUT    | `/clients/:id` | –û–Ω–æ–≤–∏—Ç–∏        |
| DELETE | `/clients/:id` | –í–∏–¥–∞–ª–∏—Ç–∏       |

---

### üìç Operator routes

| –ú–µ—Ç–æ–¥  | –ï–Ω–¥–ø–æ—ñ–Ω—Ç         | –û–ø–∏—Å           |
| ------ | ---------------- | -------------- |
| GET    | `/operators`     | –û—Ç—Ä–∏–º–∞—Ç–∏ –≤—Å—ñ—Ö  |
| GET    | `/operators/:id` | –û—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ ID |
| POST   | `/operators`     | –°—Ç–≤–æ—Ä–∏—Ç–∏       |
| PUT    | `/operators/:id` | –û–Ω–æ–≤–∏—Ç–∏        |
| DELETE | `/operators/:id` | –í–∏–¥–∞–ª–∏—Ç–∏       |

---

### üìç Fuel routes

| –ú–µ—Ç–æ–¥  | –ï–Ω–¥–ø–æ—ñ–Ω—Ç     | –û–ø–∏—Å           |
| ------ | ------------ | -------------- |
| GET    | `/fuels`     | –û—Ç—Ä–∏–º–∞—Ç–∏ –≤—Å—ñ   |
| GET    | `/fuels/:id` | –û—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ ID |
| POST   | `/fuels`     | –°—Ç–≤–æ—Ä–∏—Ç–∏       |
| PUT    | `/fuels/:id` | –û–Ω–æ–≤–∏—Ç–∏        |
| DELETE | `/fuels/:id` | –í–∏–¥–∞–ª–∏—Ç–∏       |

---

## üß™ –ü—Ä–∏–∫–ª–∞–¥–∏ –∑–∞–ø–∏—Ç—ñ–≤ (Postman)

### üîπ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–ª—ñ—î–Ω—Ç–∞

```http
POST /clients
Content-Type: application/json

{
  "first_name": "Walter",
  "last_name": "White",
  "phone_number": "+380501112233"
}
```

üîπ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–∞–ª—å–Ω–æ–≥–æ

```http
POST /fuels
{
  "fuel_name": "Diesel",
  "price": 51.99
}
```

üîπ –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞–ª—å–Ω–æ–≥–æ

```http
PUT /fuels/1
{
  "price": 48.75
}
```

## üì∑ –°–∫—Ä—ñ–Ω—à–æ—Ç–∏ Postman:

### GET /clients ‚Äî —Å–ø–∏—Å–æ–∫

<p align="center">
  <img src="./Images/Clients/List.png" width="1200" alt="NPM test results">
</p>

### POST /clients ‚Äî —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è

<p align="center">
  <img src="./Images/Clients/Create.png" width="1200" alt="NPM test results">
</p>

### GET /clients/:id‚Äî —Å–ø–∏c–æ–∫ –ø–æ ID

<p align="center">
  <img src="./Images/Clients/ID.png" width="1200" alt="NPM test results">
</p>

### PUT /clients/:id ‚Äî –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

<p align="center">
  <img src="./Images/Clients/Update.png" width="1200" alt="NPM test results">
</p>

### DELETE /clients/:id ‚Äî –≤–∏–¥–∞–ª–µ–Ω–Ω—è

<p align="center">
  <img src="./Images/Clients/Delete.png" width="1200" alt="NPM test results">
</p>

### GET /operators ‚Äî —Å–ø–∏—Å–æ–∫

<p align="center"> 
 <img src="./Images/Operator/List.png" width="1200" alt="operators list"> 
</p>

### POST /operators ‚Äî —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è

<p align="center"> 
 <img src="./Images/Operator/Create.png" width="1200" alt="operators list"> 
</p>

### GET /operators/:id ‚Äî –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ ID

<p align="center"> 
 <img src="./Images/Operator/ID.png" width="1200" alt="operators list"> 
</p>

### PUT /operators/:id ‚Äî –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

<p align="center"> 
 <img src="./Images/Operator/Update.png" width="1200" alt="operators list"> 
</p>

### DELETE /operators/:id ‚Äî –≤–∏–¥–∞–ª–µ–Ω–Ω—è

<p align="center"> 
 <img src="./Images/Operator/Delete.png" width="1200" alt="operators list"> 
</p>

### GET /fuels ‚Äî —Å–ø–∏—Å–æ–∫

<p align="center"> 
 <img src="./Images/Fuel/List.png" width="1200" alt="operators list"> 
</p>

### POST /fuels ‚Äî —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è

<p align="center"> 
 <img src="./Images/Fuel/Create.png" width="1200" alt="operators list"> 
</p>

### GET /fuels/:id ‚Äî –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ ID

<p align="center"> 
 <img src="./Images/Fuel/ID.png" width="1200" alt="operators list"> 
</p>

### PUT /fuels/:id ‚Äî –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

<p align="center"> 
 <img src="./Images/Fuel/Update.png" width="1200" alt="operators list"> 
</p>

### DELETE /fuels/:id ‚Äî –≤–∏–¥–∞–ª–µ–Ω–Ω—è

<p align="center"> 
 <img src="./Images/Fuel/Delete.png" width="1200" alt="operators list"> 
</p>

# üìå –í–∏—Å–Ω–æ–≤–æ–∫

–£ —Ä–∞–º–∫–∞—Ö –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ –±—É–ª–æ —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–æ –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–∏–π —Å–µ—Ä–≤–µ—Ä–Ω–∏–π –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫ –¥–ª—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏ –º–µ—Ä–µ–∂—ñ –ê–ó–°. –ü—Ä–æ—î–∫—Ç –ø–æ–±—É–¥–æ–≤–∞–Ω–æ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º —Å—É—á–∞—Å–Ω–∏—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π ‚Äî Node.js, Express, TypeScript —Ç–∞ TypeORM, —â–æ –¥–æ–∑–≤–æ–ª–∏–ª–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—É –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—É –∑ —á—ñ—Ç–∫–∏–º —Ä–æ–∑–ø–æ–¥—ñ–ª–æ–º –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∏, —Ä–æ—É—Ç—ñ–≤ —Ç–∞ –¥–æ—Å—Ç—É–ø—É –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö.
–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ –Ω–∞ PostgreSQL, —â–æ –∑–∞–±–µ–∑–ø–µ—á—É—î –≤–∏—Å–æ–∫–∏–π —Ä—ñ–≤–µ–Ω—å –Ω–∞–¥—ñ–π–Ω–æ—Å—Ç—ñ, —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π–Ω–æ—Å—Ç—ñ —Ç–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ —Å–∫–ª–∞–¥–Ω–∏—Ö –∑–≤‚Äô—è–∑–∫—ñ–≤ –º—ñ–∂ —Å—É—Ç–Ω–æ—Å—Ç—è–º–∏. –£—Å—ñ —Ç–∞–±–ª–∏—Ü—ñ –ø–æ–±—É–¥–æ–≤–∞–Ω—ñ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º GENERATED ALWAYS AS IDENTITY, —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Å—É—á–∞—Å–Ω–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º –∑–∞–º—ñ—Å—Ç—å –∑–∞—Å—Ç–∞—Ä—ñ–ª–æ–≥–æ —Ç–∏–ø—É SERIAL.
–°—É—Ç–Ω–æ—Å—Ç—ñ Client, Operator —Ç–∞ Fuel —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ –≤–∏–º–æ–≥ –ø—Ä–µ–¥–º–µ—Ç–Ω–æ—ó –æ–±–ª–∞—Å—Ç—ñ. –î–ª—è –∫–æ–∂–Ω–æ—ó —Å—É—Ç–Ω–æ—Å—Ç—ñ —Å—Ç–≤–æ—Ä–µ–Ω–æ –º–æ–¥–µ–ª—ñ, –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∏, —Ä–æ—É—Ç–µ—Ä–∏ —Ç–∞ —Å–µ—Ä–≤—ñ—Å–Ω—ñ –º–µ—Ç–æ–¥–∏, —â–æ –∑–∞–±–µ–∑–ø–µ—á—É—é—Ç—å —á–∏—Å—Ç—É —Ç–∞ –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–¥—É.
–î–ª—è –∫–æ–∂–Ω–æ—ó —Å—É—Ç–Ω–æ—Å—Ç—ñ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ CRUD-–µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏, —â–æ –≤–∫–ª—é—á–∞—é—Ç—å –æ–ø–µ—Ä–∞—Ü—ñ—ó —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è, –æ—Ç—Ä–∏–º–∞–Ω–Ω—è, –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è. –£—Å—ñ –º–∞—Ä—à—Ä—É—Ç–∏ –ø—Ä–æ—Ç–µ—Å—Ç–æ–≤–∞–Ω—ñ —á–µ—Ä–µ–∑ Postman, –∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∑–∞–ø–∏—Ç—ñ–≤ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω—ñ —É –≤–∏–≥–ª—è–¥—ñ —Å–∫—Ä—ñ–Ω—à–æ—Ç—ñ–≤, —â–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω—ñ—Å—Ç—å —Ä–æ–±–æ—Ç–∏ API.
–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ —Å—Ç–≤–æ—Ä–µ–Ω–æ –≥–æ—Ç–æ–≤—É –¥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —á–∞—Å—Ç–∏–Ω—É –±–µ–∫–µ–Ω–¥-—Å–∏—Å—Ç–µ–º–∏, —è–∫–∞ –º–æ–∂–µ –±—É—Ç–∏ –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω–∞ –Ω–æ–≤–∏–º–∏ —Å—É—Ç–Ω–æ—Å—Ç—è–º–∏, –º–æ–¥—É–ª—è–º–∏, —Å–µ—Ä–≤—ñ—Å–∞–º–∏ —Ç–∞ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—é. –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞ —è–∫ –æ—Å–Ω–æ–≤–∞ –¥–ª—è –º–∞–π–±—É—Ç–Ω—å–æ—ó –∫—É—Ä—Å–æ–≤–æ—ó —Ä–æ–±–æ—Ç–∏ –∞–±–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É –º–µ—Ä–µ–∂—ñ –ê–ó–°.
